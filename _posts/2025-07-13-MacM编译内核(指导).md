---
layout: post
title:  "MacMç¼–è¯‘å†…æ ¸(æŒ‡å¯¼)"
date: 2025-07-13
permalink: /MacMç¼–è¯‘å†…æ ¸(æŒ‡å¯¼).html

---

# Mac Mç¼–è¯‘å†…æ ¸(æŒ‡å¯¼)

> [!WARNING]
>
> è¿™æ˜¯ä¸æˆåŠŸçš„éƒ¨åˆ†,å¦‚æœä½ æƒ³æŒ‘æˆ˜Macä¸Šç¼–è¯‘å®‰å“å†…æ ¸,ä¸‹é¢å†…å®¹æˆ–è®¸å¯ä»¥å¸®ä½ é¿å¼€ä¸€äº›å‘.ä½†æ˜¯æˆ‘è¿˜æ˜¯çœŸè¯šåœ°æ¨è**OrbStack**è™šæ‹Ÿæœºæ–¹æ¡ˆ.

## é¢„å¤‡:

[ROM](https://crdroid.net/corvette/11)

[Device Tree](https://github.com/crdroidandroid/android_device_oneplus_corvette)

[Kernel](https://github.com/crdroidandroid/android_kernel_oneplus_sm8650)

## å‚è€ƒ:

[ç¼–è¯‘ç¯å¢ƒé…ç½®](https://wu1015.github.io/2025/02/15/mix2s-kernelsu-build/)

[Susfs](https://github.com/SukiSU-Ultra/SukiSU-Ultra)

[Docker Gist](https://gist.github.com/FreddieOliveira/efe850df7ff3951cb62d74bd770dce27)

## æ„å»ºå°è¯•:

* äº¤å‰ç¼–è¯‘å·¥å…·éƒ¨ç½²:

```zsh
# æ²¡ç”¨,æ³¨æ„ä¸‹é¢ä¸¤ç§LOSå’ŒAOSP clang
# NDKå®‰è£…(é€šè¿‡Android Studio,åºŸå¼ƒç‰ˆæœ¬)
# ~/Library/Android/sdk
# export ANDROID_NDK_HOME="${HOME}/Library/Android/sdk/ndk/29.0.13599879" 
# export PATH=$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/darwin-x86_64/bin:$PATH
# å®˜ç½‘(https://developer.android.com/ndk/downloads?hl=zh-cn#lts-downloads)

# Los(6.1ä»¥ä¸Šç”¨clang)
# git clone https://github.com/LineageOS/android_prebuilts_gcc_darwin-x86_aarch64_aarch64-linux-android-4.9.git --depth=1 gcc_aarch64
# git clone https://github.com/LineageOS/android_prebuilts_gcc_darwin-x86_arm_arm-linux-androideabi-4.9.git --depth=1 gcc_arm
# PATH="${HOME}/Desktop/OnePlusAce3Pro/gcc_aarch64/bin:${PATH}"

# AOSP clang
git clone https://android.googlesource.com/platform/prebuilts/clang/host/darwin-x86 --depth=1 clang  
PATH="${HOME}/Desktop/OnePlusAce3Pro/clang/clang-r547379/bin:${PATH}"

# LLVMä¼¼ä¹ä¸è¡Œ
brew install --cask llvm

# ä½¿ç”¨Gmake,macä¸Šçš„makeç‰ˆæœ¬è¾ƒè€
brew install --cask make


# https://xdaforums.com/t/guide-building-android-kernel-on-osx.3431794/
brew install libelf
sudo ln /opt/homebrew/include/libelf/gelf.h /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/elf.h
 sudo ln -s /opt/homebrew/include/libelf /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/libelf

# https://github.com/smarco/WFA2-lib/issues/88
#  #include <endian.h> æ”¹ä¸º#include <machine/endian.h>
# æˆ–è€… <sys/types.h>
sudo ln /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/machine/endian.h /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/endian.h

# æ¥ä¸‹æ¥,ä½ ä¼šé‡åˆ°å‡ ä¸ªé—®é¢˜
# å®ä¿æŠ¤ç‚¸
# ä¾èµ–å¤§çˆ†ç‚¸:æ¯”å¦‚,ä¾èµ–åˆ°linuxå¤´æ–‡ä»¶
```



* åˆ‡æ¢åˆ†åŒº,é˜²æ­¢ç ´ååŸåˆ†åŒº:

```zsh
# å·²æ‹‰ä¸‹å†…æ ¸
kernel on î‚  15.0 [!] via ğŸ v3.9.6
â¯ git checkout -b deploy
åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯ 'deploy'

```



* æŸ¥æ‰¾defconfig

  ```zsh
  # ç¡®è®¤æœºå‹çš„defconfigåœ¨ä¸åœ¨
  greenhandzdl@arch /U/g/D/O/kernel (deploy)> ls arch/arm64/configs/vendor/oplus/corvette.config
  arch/arm64/configs/vendor/oplus/corvette.config
  
  # gkiåœ¨ä¸åœ¨
  kernel on î‚  15.0 via ğŸ v3.9.6
  â¯ ls arch/arm64/configs/gki_defconfig
  arch/arm64/configs/gki_defconfig
  ```

  

* ç¼–è¯‘

  ```zsh
  export PATH=~/Desktop/OnePlusAce3Pro/clang/clang-stable/bin:$PATH
  export ARCH=arm64
  
  # é˜²æ­¢æ‰¾ä¸åˆ°å¤´æ–‡ä»¶
  export C_INCLUDE_PATH=/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include
  
  # é˜²æ­¢ldæŠ¥é”™
  export SDKROOT=$(xcrun --show-sdk-path)
  
  gmake O=out ARCH=arm64 LLVM=1 LLVM_IAS=1 gki_defconfig
  
  # linuxç”¨nproc
  gmake -j$(sysctl -n hw.ncpu) O=out ARCH=arm64 LLVM=1 LLVM_IAS=1 V=1
  
  ```
  
  
  
  
